{% extends 'loft/base.html' %}

{% block breadcrumb %}{{ block.super }} &raquo; {{ object.title|title }}{% endblock %}

{% load comments %}

{% block scripts %}
<script src="{{ MEDIA_URL }}js/post-comment.js" type="text/javascript"></script>
<script type="text/javascript" charset="utf-8">
$(document).ready(function() {
    $('#commentForm').submit(function() {
        ajaxComment({'media': '{{ MEDIA_URL }}'});
        return false;
    });
});
</script>
{% endblock scripts %}

{% block title %} | {{ object.title }}{% endblock title %}

{% block primary_content %}
    {% include "loft/includes/entry_object_full.html" %}

    {% load comments %}
    {% get_comment_count for object as comment_count %}
    {% get_comment_list for object as comments %}
    
    {% if comment_count %}
        <h2>{{ comment_count }} Comment{{ comment_count|pluralize }}</h2>
    {% endif %}
    <div id="comments">
        {% for comment in comments %}
        <div class="commentContainer" id="comment-{{comment.id}}">
            <div class="comment">
                {{ comment.comment }}
            </div>
            <ul class="commentMetadata">
                <li>{{forloop.counter}}.</li>
                {% if comment.user_url %}
                    <li><a href="{{ comment.user_url }}">{{ comment.user_name }}</a></li>
                {% else %}
                    <li>{{ comment.user_name }}</li>
                {% endif %}
                <li>{{ comment.submit_date|date:"D jS M" }}<br/>{{ comment.submit_date|date:"Y" }}</li>
            </ul>
        </div>
        {% endfor %}
    </div>

    {# Comment Form #}
    <div id="commentFormContainer">
        <h2>Add Your Opinions</h2>
        {% get_comment_form for object as form %}
        {% include "loft/includes/comment_form.html" %}
    </div>
{% endblock primary_content %}